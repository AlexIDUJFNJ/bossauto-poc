<!DOCTYPE html>
<html>
<head>
    <title>BossAuto - Flujo 1: Motor de Aprobaciones</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 40px;
            margin: 0;
        }
        .workflow-container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: #ff6d5a;
            margin-bottom: 30px;
            font-size: 24px;
        }
        .workflow {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 20px;
        }
        .node {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .node-box {
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px 25px;
            min-width: 250px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-weight: 500;
        }
        .node-box.trigger {
            background: #ff6d5a;
            color: white;
            border-color: #ff6d5a;
        }
        .node-box.function {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
        .node-box.database {
            background: #2196F3;
            color: white;
            border-color: #2196F3;
        }
        .node-box.api {
            background: #FF9800;
            color: white;
            border-color: #FF9800;
        }
        .node-box.notification {
            background: #9C27B0;
            color: white;
            border-color: #9C27B0;
        }
        .node-box.split {
            background: #FFC107;
            color: black;
            border-color: #FFC107;
        }
        .arrow {
            color: #666;
            font-size: 24px;
        }
        .description {
            color: #666;
            font-size: 13px;
            margin-left: 15px;
        }
        .branch {
            display: flex;
            gap: 30px;
            margin-left: 50px;
            padding: 20px;
            border-left: 3px solid #ddd;
        }
        .branch-path {
            flex: 1;
        }
        .branch-label {
            font-weight: bold;
            color: #666;
            margin-bottom: 10px;
            font-size: 14px;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #eee;
        }
        .stat-box {
            text-align: center;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 6px;
        }
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #ff6d5a;
        }
        .stat-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="workflow-container">
        <h1>üîÑ BossAuto - Flujo 1: Motor de Aprobaciones Multinivel</h1>

        <div class="workflow">
            <!-- Node 1 -->
            <div class="node">
                <div class="node-box trigger">
                    üì• Webhook Trigger
                </div>
                <span class="description">Recibe solicitudes de compra (POST request)</span>
            </div>
            <div class="arrow">‚Üì</div>

            <!-- Node 2 -->
            <div class="node">
                <div class="node-box function">
                    ‚úÖ Validate Input
                </div>
                <span class="description">Valida estructura JSON y campos obligatorios</span>
            </div>
            <div class="arrow">‚Üì</div>

            <!-- Node 3 -->
            <div class="node">
                <div class="node-box database">
                    üíæ Save to PostgreSQL
                </div>
                <span class="description">INSERT en tabla purchase_requests</span>
            </div>
            <div class="arrow">‚Üì</div>

            <!-- Node 4 -->
            <div class="node">
                <div class="node-box database">
                    üìã Get Approval Rules
                </div>
                <span class="description">SELECT rules WHERE amount BETWEEN min AND max</span>
            </div>
            <div class="arrow">‚Üì</div>

            <!-- Node 5 -->
            <div class="node">
                <div class="node-box function">
                    ‚öôÔ∏è Apply Business Rules
                </div>
                <span class="description">Determina nivel: auto / manager / director / CEO</span>
            </div>
            <div class="arrow">‚Üì</div>

            <!-- Node 6 -->
            <div class="node">
                <div class="node-box function">
                    ‚è∞ Calculate SLA Deadline
                </div>
                <span class="description">Fecha l√≠mite = NOW + SLA hours</span>
            </div>
            <div class="arrow">‚Üì</div>

            <!-- Branch Point -->
            <div class="node">
                <div class="node-box split">
                    üîÄ Branch: Auto-approval?
                </div>
            </div>

            <!-- Branches -->
            <div class="branch">
                <!-- Left Branch: Auto-approval -->
                <div class="branch-path">
                    <div class="branch-label">‚úÖ YES (< $1,000)</div>
                    <div class="node">
                        <div class="node-box api">
                            üîó Create PO in BC
                        </div>
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="node">
                        <div class="node-box notification">
                            üìß Send Notification
                        </div>
                    </div>
                </div>

                <!-- Right Branch: Manual approval -->
                <div class="branch-path">
                    <div class="branch-label">‚è≥ NO (‚â• $1,000)</div>
                    <div class="node">
                        <div class="node-box database">
                            üìù Save to approval_history
                        </div>
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="node">
                        <div class="node-box notification">
                            üîî Notify Approver
                        </div>
                    </div>
                </div>
            </div>

            <div class="arrow">‚Üì</div>

            <!-- Final nodes -->
            <div class="node">
                <div class="node-box database">
                    üìä Log to system_logs
                </div>
                <span class="description">Registra toda la transacci√≥n para auditor√≠a</span>
            </div>
            <div class="arrow">‚Üì</div>

            <div class="node">
                <div class="node-box function">
                    ‚ú® Return Response
                </div>
                <span class="description">JSON con status, approval_level, SLA, etc.</span>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats">
            <div class="stat-box">
                <div class="stat-value">12</div>
                <div class="stat-label">Nodes Total</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">4</div>
                <div class="stat-label">Approval Levels</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">6</div>
                <div class="stat-label">DB Operations</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">~2s</div>
                <div class="stat-label">Avg Response Time</div>
            </div>
        </div>
    </div>
</body>
</html>
